<section>
  <form name="conditionPanelWatcherEdit.form" ng-model-options="{ getterSetter: true }" novalidate>
    <div class="row">
      <div class="col-md-12">
        <div class="panel-body">
          <div class="row watcher-editor-panel-header">
            <div class="col-md-6">
              <header>
                <h4 class="form-text">
                  Match condition
                </h4>
              </header>
            </div>
          </div> <!-- END header -->
          <hr>
          <div class="row watcher-editor-panel-paragraph">
            <div id="watcher-editor-condition-dd-menu" class="col-md-9">
              <ul>
                <li class="watcher-editor-condition-dd">
                  <dd-watcher-agg-type
                    agg-type-selected="conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.queryType"
                    agg-type-on-select="conditionPanelWatcherEdit.condition.type.handleSelect(type)"
                    text-limit="conditionPanelWatcherEdit.condition.textLimit"
                  ></dd-watcher-agg-type/>
                </li>
                <li class="watcher-editor-condition-dd">
                  <dd-watcher-agg-field
                    agg-enabled="conditionPanelWatcherEdit.condition.field.aggEnabled"
                    active-field="{{conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.field}}"
                    field-names="conditionPanelWatcherEdit.indexesData.fieldNames"
                    time-field="{{conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.timeField}}"
                    on-select-field="conditionPanelWatcherEdit.condition.field.handleFieldSelect(field)"
                    on-select-time-field="conditionPanelWatcherEdit.condition.field.handleTimeFieldSelect(timeField)"
                    text-limit="conditionPanelWatcherEdit.condition.textLimit"
                  ></dd-watcher-agg-field/>
                </li>
                <li class="watcher-editor-condition-dd">
                  <dd-watcher-agg-over
                    agg-over-options="conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.over"
                    agg-field-names="conditionPanelWatcherEdit.indexesData.fieldNames"
                    agg-over-on-select="conditionPanelWatcherEdit.condition.over.handleSelect(over)"
                    text-limit="conditionPanelWatcherEdit.condition.textLimit"
                  ></dd-watcher-agg-over/>
                </li>
                <li class="watcher-editor-condition-dd">
                  <dd-watcher-agg-threshold
                    agg-threshold-options="conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.threshold"
                    agg-threshold-on-select="conditionPanelWatcherEdit.condition.threshold.handleSelect(direction, n)"
                    text-limit="conditionPanelWatcherEdit.condition.textLimit"
                  ></dd-watcher-agg-threshold/>
                </li>
                <li class="watcher-editor-condition-dd">
                  <dd-watcher-agg-time
                    agg-time-options="conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.last"
                    agg-time-on-select="conditionPanelWatcherEdit.condition.last.handleSelect(unit, n)"
                    text-limit="conditionPanelWatcherEdit.condition.textLimit"
                  ></dd-watcher-agg-time/>
                </li>
                <li class="watcher-editor-condition-dd">
                  <dd-watcher-agg-interval
                    agg-interval-options="conditionPanelWatcherEdit.watcher._source.wizard.chart_query_params.interval"
                    agg-interval-on-select="conditionPanelWatcherEdit.condition.interval.handleSelect(unit, n)"
                    text-limit="conditionPanelWatcherEdit.condition.textLimit"
                  ></dd-watcher-agg-interval/>
                </li>
              </ul>
            </div>
            <div class="col-md-3" id="watcher-editor-condition-views">
              <div class="form-inline">
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-sm"
                    ng-class="conditionPanelWatcherEdit.content.views.chart.show ? 'btn-primary' : 'btn-default'"
                    ng-click="conditionPanelWatcherEdit.content.toggle('chart')"
                  >
                    chart
                  </button>
                </div>
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-sm btn-default"
                    ng-class="conditionPanelWatcherEdit.content.views.chartquery.show ? 'btn-primary' : 'btn-default'"
                    ng-click="conditionPanelWatcherEdit.content.toggle('chartquery')"
                  >
                    chart query
                  </button>
                </div>
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-sm btn-default"
                    ng-class="conditionPanelWatcherEdit.content.views.watcherquery.show ? 'btn-primary' : 'btn-default'"
                    ng-click="conditionPanelWatcherEdit.content.toggle('watcherquery')"
                  >
                    watcher query
                  </button>
                </div>
              </div>
            </div>
          </div> <!-- END condition based query builder -->
          <div class="row" ng-show="conditionPanelWatcherEdit.content.views.chart.show">
            <div class="col-md-1">
              <div class="form-group">
                <p ng-show="conditionPanelWatcherEdit.activeChart.enabled">
                  <i class="fa fa-area-chart"></i> {{conditionPanelWatcherEdit.activeChart.name}}
                </p>
              </div>
            </div>
            <div class="col-md-1">
              <div class="form-inline">
                <div class="form-group">
                  <button 
                    type="button"
                    class="btn btn-sm btn-default"
                    aria-label="Left Align"
                    ng-click="conditionPanelWatcherEdit.switchToLeftChart()"
                    ng-show="conditionPanelWatcherEdit.areMultipleCharts && conditionPanelWatcherEdit.isAnyActiveChart"
                  >
                    <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
                  </button>
                </div>
                <div class="form-group">
                  <button
                    type="button"
                    class="btn btn-sm btn-default"
                    aria-label="Left Align"
                    ng-click="conditionPanelWatcherEdit.switchToRightChart()"
                    ng-show="conditionPanelWatcherEdit.areMultipleCharts && conditionPanelWatcherEdit.isAnyActiveChart"
                  >
                    <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="row" id="watcher-editor-condition-content" >
            <div class="col-md-12">
              <div
                class="form-group chart-container"
                ng-show="conditionPanelWatcherEdit.activeChart.enabled && conditionPanelWatcherEdit.content.views.chart.show">
                <small class="form-text text-muted">Historical data:</small>
                <canvas
                  class="chart chart-line"
                  chart-data="conditionPanelWatcherEdit.activeChart.yAxis"
                  chart-labels="conditionPanelWatcherEdit.activeChart.xAxis"
                  chart-options="conditionPanelWatcherEdit.activeChart.options"
                  chart-click="conditionPanelWatcherEdit.onChartClick"
                ></canvas> 
              </div>
              <div class="alert alert-warning" role="alert" ng-show="!conditionPanelWatcherEdit.isAnyActiveChart">
                <p>{{conditionPanelWatcherEdit.messages.nodata}}</p>
              </div>
              <div class="form-group" ng-show="conditionPanelWatcherEdit.content.views.chartquery.show">
                <small class="form-text text-muted">Chart query (read only). <a ng-click="conditionPanelWatcherEdit.turnIntoAdvanced()">Turn into advanced</a></small>
                
                <div
                  readonly
                  ui-ace="conditionPanelWatcherEdit.aceOptions({mode: 'json', maxLines: 30, minLines: 30})"
                  ng-model="conditionPanelWatcherEdit.rawDoc.chart.text"
                >
                  {{conditionPanelWatcherEdit.rawDoc.chart.text}}
                </div>
              </div>
              <div class="form-group" ng-show="conditionPanelWatcherEdit.content.views.watcherquery.show">
                <small class="form-text text-muted">Watcher raw (read only). <a ng-click="conditionPanelWatcherEdit.turnIntoAdvanced()">Turn into advanced</a></small>
                <div
                  readonly
                  ui-ace="conditionPanelWatcherEdit.aceOptions({mode: 'json', maxLines: 30, minLines: 30})"
                  ng-model="conditionPanelWatcherEdit.rawDoc.watcher.text"
                >
                  {{conditionPanelWatcherEdit.rawDoc.watcher.text}}
                </div>
              </div>
            </div>
          </div> <!-- END chart, data hostory -->
        </div>
      </div>
    </div>
  </form>
</section>
