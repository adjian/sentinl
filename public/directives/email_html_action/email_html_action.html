<div uib-accordion-group class="panel-default" is-open="emailHtmlAction.isOpen">
  <uib-accordion-heading>
    {{emailHtmlAction.actionSettings.$$title}} <i class="pull-right glyphicon"
    ng-class="{'glyphicon-chevron-down': emailHtmlAction.isOpen, 'glyphicon-chevron-right': !emailHtmlAction.isOpen}"></i>
  </uib-accordion-heading>

  <div class="row" id="email-html-action" class="action-panel">
    <div class="col-12">
      <div class="well" ng-form="emailHtmlForm">

        <div class="page-header">
          <h4><small>{{emailHtmlAction.type}} action</small></h4>
        </div> <!-- end page-header -->

        <div class="form-group">
          <div class="col-md-2 period-tag-label">
            <label>Throttle</label>
          </div>
          <div class="col-md-10">
            <period-tag timesrc="emailHtmlAction.actionSettings.$$throttle"></period-tag>
          </div>
        </div>

        <div class="form-group">
          <label class="col-md-2 control-label">Priority</label>
          <div class="btn-group col-md-2">
            <select
              class="form-control condition-select"
              ng-model="emailHtmlAction.actionSettings.email_html.priority"
              ng-options="o as o for o in emailHtmlAction.actionPriorities"
            ></select>
          </div>
          <div class="col-md-2">
            <label class="checkbox">
              <input type="checkbox"
                ng-model="emailHtmlAction.actionSettings.email_html.stateless"
                ng-checked="emailHtmlAction.actionSettings.email_html.stateless"
              /> stateless
            </label>
          </div>
          <div class="col-md-3">
            <input type="checkbox"
              ng-model="emailHtmlAction.actionSettings.email_html.save_payload"
              ng-checked="emailHtmlAction.actionSettings.email_html.save_payload"
            /> save payload
            <i class="fa fa-question-circle"
              aria-hidden="true"
              uib-popover="{{emailHtmlAction.help.action.save_payload}}"
              popover-trigger="'outsideClick'"></i>
          </div>
        </div> <!-- end form-group -->

        <div class="form-group" ng-class="{'has-error': emailHtmlForm.emailHtmlTitle.$invalid && !emailHtmlForm.emailHtmlTitle.$pristine}">
          <label class="col-md-2 control-label" for="emailHtmlTitle">Title</label>
          <div class="col-md-10">
            <input
              type="text"
              id="emailHtmlTitle"
              name="emailHtmlTitle"
              value="{{emailHtmlAction.actionName}}"
              class="form-control"
              placeholder="{{watcher._id}}"
              ng-model="emailHtmlAction.actionSettings.$$title"
              ng-required="emailHtmlAction.actionSettings.email_html.$$edit"
            />
          </div>
          <p ng-show="emailHtmlForm.emailHtmlTitle.$invalid && !emailHtmlForm.emailHtmlTitle.$pristine" class="help-block">
            Action title is required.
          </p>
        </div> <!-- end form-group -->

        <div class="form-group" ng-class="{'has-error': emailHtmlForm.emailHtmlTo.$invalid && !emailHtmlForm.emailHtmlTo.$pristine}">
          <label class="col-md-2 control-label" for="emailHtmlTo">To</label>
          <div class="col-md-10">
            <input
              type="text"
              id="emailHtmlTo"
              name="emailHtmlTo"
              value="{{emailHtmlAction.actionSettings.email_html.to}}"
              class="form-control"
              placeholder="root@localhost"
              ng-model="emailHtmlAction.actionSettings.email_html.to"
              ng-required="emailHtmlAction.actionSettings.email_html.$$edit"
            />
          </div>
          <p ng-show="emailHtmlForm.emailHtmlTo.$invalid && !emailHtmlForm.emailHtmlTo.$pristine" class="help-block">
            Enter a valid emailHtml.
          </p>
        </div> <!-- end form-group -->

        <div class="form-group" ng-class="{'has-error': emailHtmlForm.emailHtmlFrom.$invalid && !emailHtmlForm.emailHtmlFrom.$pristine}">
          <label class="col-md-2 control-label" for="emailHtmlFrom">From</label>
          <div class="col-md-10">
            <input
              type="text"
              id="emailHtmlFrom"
              name="emailHtmlFrom"
              value="{{emailHtmlAction.actionSettings.email_html.from}}"
              class="form-control"
              placeholder="sentinl@localhost"
              ng-model="emailHtmlAction.actionSettings.email_html.from"
              ng-required="emailHtmlAction.actionSettings.email_html.$$edit"
            />
          </div>
          <p ng-show="emailHtmlForm.emailHtmlFrom.$invalid && !emailHtmlForm.emailHtmlFrom.$pristine" class="help-block">
            Enter a valid emailHtml.
          </p>
        </div> <!-- end form-group -->

        <div class="form-group" ng-class="{'has-error': emailHtmlForm.emailHtmlSubject.$invalid && !emailHtmlForm.emailHtmlSubject.$pristine}">
          <label class="col-md-2 control-label" for="emailHtmlSubject">Subject</label>
          <div class="col-md-10">
            <input
              type="text"
              id="emailHtmlSubject"
              name="emailHtmlSubject"
              value="{{emailHtmlAction.actionSettings.email_html.subject}}"
              class="form-control"
              placeholder="Alarm Title"
              ng-model="emailHtmlAction.actionSettings.email_html.subject"
              ng-required="emailHtmlAction.actionSettings.email_html.$$edit"
            />
          </div>
          <p ng-show="emailHtmlForm.emailHtmlSubject.$invalid && !emailHtmlForm.emailHtmlSubject.$pristine" class="help-block">
            Enter a subject.
          </p>
        </div> <!-- end form-group -->

        <div class="form-group" ng-class="{'has-error': !emailHtmlAction.actionSettings.email_html.body.length}">
          <label class="col-md-2 control-label" for="emailHtmlBody">Body</label>
          <div class="col-md-10">
            <div id="emailHtmlBody"
              ng-model="emailHtmlAction.actionSettings.email_html.body"
              ui-ace="emailHtmlAction.aceOptions({mode: 'behaviour'})"
            >{{emailHtmlAction.actionSettings.email_html.body}}
            </div>
          </div>
          <p ng-show="!emailHtmlAction.actionSettings.email_html.body.length" class="text-warning">
            Describe the alert in the email body.
          </p>
        </div> <!-- end form-group -->

        <div class="form-group" ng-class="{'has-error': !emailHtmlAction.actionSettings.email_html.html.length}">
          <label class="col-md-2 control-label" for="emailHtmlBody">Body HTML</label>
          <div class="col-md-10">
            <div id="emailHtmlBody"
              ng-model="emailHtmlAction.actionSettings.email_html.html"
              ui-ace="emailHtmlAction.aceOptions({mode: 'html'})"
            >{{emailHtmlAction.actionSettings.email_html.html}}
            </div>
          </div>
          <p ng-show="!emailHtmlAction.actionSettings.email_html.html.length" class="text-warning">
            Describe the alert in the email body HTML.
          </p>
        </div> <!-- end form-group -->

        <div class="form-group control-actions">
          <button type="button" class="btn btn-danger pull-right" ng-click="emailHtmlAction.remove()">Delete</button>
        </div> <!-- end form-group -->

      </div> <!-- end well -->
    </div> <!-- end col-12 -->
  </div> <!-- end email-action -->
</div> <!-- end uib-accordion-group -->
